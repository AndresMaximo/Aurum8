<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Checklist Técnico 3D • AURUM∞</title>
  <link rel="stylesheet" href="style.css" />
  <link rel="stylesheet" href="lemuria.css" />
  <style>
    .grid{display:grid;gap:16px}
    @media(min-width:900px){.grid{grid-template-columns:1.2fr .8fr}}
    .panel{background:var(--bg-card);border:1px solid var(--gold-20);border-radius:14px;padding:16px;box-shadow:var(--shadow)}
    .point{border-bottom:1px dashed var(--gold-20);padding:10px 0}
    .point:last-child{border-bottom:0}
    .badges{display:flex;gap:10px;align-items:center;margin:8px 0}
    .pill{padding:.2rem .55rem;border-radius:999px;font-size:.85rem}
    .ok{background:#0b4; color:#eaffea}
    .obs{background:#b8860b; color:#fff3cd}
    .nc{background:#7a0b0b; color:#ffdede}
    .tools{display:flex;gap:8px;flex-wrap:wrap}
    .sticky{position:sticky; top:82px}
  </style>
</head>
<body>
  <header class="top">
    <h1>AURUM∞</h1>
    <nav>
      <a href="index.html">Inicio</a>
      <a href="vision.html">Visión</a>
      <a href="modulos.html">Módulos</a>
      <a href="contacto.html">Contacto</a>
    </nav>
  </header>

  <main class="container grid">
    <section class="panel">
      <h2>Checklist Técnico · 50 puntos</h2>
      <p class="muted">Equipo: <strong>Toyota Hilux</strong> · ID: <input id="ctxId" placeholder="HILUX-A8-001" /></p>

      <div id="points"></div>
    </section>

    <aside class="panel sticky">
      <h3>Controles</h3>
      <div class="tools">
        <button id="btnSave" class="btn gold">Guardar local</button>
        <button id="btnLoad" class="btn">Cargar</button>
        <button id="btnClear" class="btn">Borrar</button>
        <button id="btnCSV" class="btn gold">Exportar CSV</button>
      </div>

      <h4 style="margin-top:16px">Ir al punto</h4>
      <select id="goto" style="width:100%"></select>

      <div style="margin-top:16px">
        <label>Adjuntar evidencia</label>
        <input id="files" type="file" multiple />
        <p class="muted">Las evidencias no se exportan; se conservarán cuando conectemos backend.</p>
      </div>
    </aside>
  </main>

  <footer class="footer">© 2025 AURUM∞</footer>

  <script>
    const N = 50;
    const KEY = 'aurum_checklist_50';
    const labels = [
      'Carrocería','Luces','Neumáticos','Llantas','Chasis / Bastidor','Frenos','Dirección','Suspensión','Amortiguadores','Motor',
      'Transmisión','Radiador','Batería','Bocina','Cinturones','Airbags','Espejos','Parabrisas','Limpiaparabrisas','Fluidos',
      'Escape','Filtro aire','Filtro aceite','Filtro combustible','Sistema eléctrico','Conexiones','Computador a bordo','OBD','Climatización','Compresor A/C',
      'Tapicería','Asientos','Alfombras','Gomas puertas','Cerraduras','Ventanas','Puertas','Capó','Pick-up/Carrocería trasera','Pernos / torque',
      'Gata / herramientas','Kit emergencia','Extintor','Triángulos','Botiquín','Documentación','Etiqueta QR','Señalética','Ruidos / vibraciones','Prueba ruta'
    ];
    const pointsEl = document.getElementById('points');
    const gotoSel = document.getElementById('goto');

    function row(i, label){
      return `
      <div class="point" id="p${i}">
        <h4>Punto ${i+1} · ${label}</h4>
        <div class="badges">
          <label><input type="radio" name="st${i}" value="OK"> <span class="pill ok">OK</span></label>
          <label><input type="radio" name="st${i}" value="OBS"> <span class="pill obs">Observación</span></label>
          <label><input type="radio" name="st${i}" value="NC"> <span class="pill nc">No Conforme</span></label>
        </div>
        <input placeholder="Comentario / hallazgo…" id="c${i}" />
      </div>`;
    }

    function build(){
      pointsEl.innerHTML = labels.map((l,i)=>row(i,l)).join('');
      gotoSel.innerHTML = labels.map((l,i)=>`<option value="${i}">#${i+1} · ${l}</option>`).join('');
    }

    function read(){
      const data = { ctxId: document.getElementById('ctxId').value, pts: [] };
      for(let i=0;i<N;i++){
        const st = document.querySelector(`input[name="st${i}"]:checked`);
        data.pts.push({ s: st?st.value:'', c: document.getElementById('c'+i).value });
      }
      return data;
    }

    function apply(d){
      if(!d) return;
      document.getElementById('ctxId').value = d.ctxId||'';
      (d.pts||[]).forEach((p,i)=>{
        if(p.s){ const r = document.querySelector(`input[name="st${i}"][value="${p.s}"]`); if(r) r.checked = true; }
        document.getElementById('c'+i).value = p.c||'';
      });
    }

    function save(){ localStorage.setItem(KEY, JSON.stringify(read())); alert('Guardado local.'); }
    function load(){ apply(JSON.parse(localStorage.getItem(KEY)||'null')); }
    function clearAll(){ if(confirm('¿Borrar guardado local del checklist?')){ localStorage.removeItem(KEY); location.reload(); } }
    function csv(){
      const d = read();
      const head = ['Punto','Etiqueta','Estado','Comentario'];
      const rows = labels.map((l,i)=>{
        const st = document.querySelector(`input[name="st${i}"]:checked`);
        return [i+1, l, st?st.value:'', document.getElementById('c'+i).value];
      });
      const esc = v => `"${(v||'').toString().replace(/"/g,'""')}"`;
      const csv = [head.map(esc).join(',')].concat(rows.map(r=>r.map(esc).join(','))).join('\n');
      const blob = new Blob([csv], {type:'text/csv;charset=utf-8;'});
      const a = document.createElement('a');
      a.href = URL.createObjectURL(blob);
      a.download = (d.ctxId||'checklist')+'_50pts.csv';
      a.click();
      URL.revokeObjectURL(a.href);
    }

    document.getElementById('btnSave').onclick = save;
    document.getElementById('btnLoad').onclick = load;
    document.getElementById('btnClear').onclick = clearAll;
    document.getElementById('btnCSV').onclick = csv;
    document.getElementById('goto').onchange = e => {
      const i = +e.target.value;
      document.getElementById('p'+i).scrollIntoView({behavior:'smooth', block:'start'});
    };

    build(); load();
  </script>
</body>
</html>