<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Numerología Vibracional · AURUM∞</title>

  <!-- Estilos base + tema Lemuriano -->
  <link rel="stylesheet" href="style.css">
  <link rel="stylesheet" href="lemuria.css">

  <style>
    main{max-width:1000px;margin:20px auto;padding:0 16px}
    .grid{display:grid;gap:14px}
    @media (min-width:900px){ .grid.cols-2{grid-template-columns:1fr 1fr} }
    .card{background:var(--bg-card);border:1px solid var(--gold-20);
      border-radius:14px;padding:18px;box-shadow:var(--shadow)}
    .field{display:flex;flex-direction:column;gap:6px}
    .field input{background:#0f1e21;border:1px solid var(--gold-20);
      border-radius:10px;color:var(--text);padding:12px 14px;font-size:1rem}
    .hint{opacity:.75}
    .kpi{display:flex;align-items:center;gap:10px;margin:6px 0}
    .kpi .n{font-size:2rem;font-weight:800;color:var(--gold);min-width:2.8ch;text-align:center}
    button{background:linear-gradient(90deg,#b8860b,#ffd700);color:#0d0d0d;
      font-weight:700;border:none;border-radius:12px;padding:12px 16px;cursor:pointer}
    .pill{display:inline-flex;gap:8px;align-items:center;padding:8px 12px;border-radius:999px;
      background:#0f1e21;border:1px solid var(--gold-20)}
    table{width:100%;border-collapse:collapse;margin-top:8px;font-size:.95rem}
    th,td{border-bottom:1px dashed var(--gold-20);padding:8px 6px;text-align:left}
    th{color:var(--gold)}
    .mapping{font-variant-numeric:tabular-nums}
  </style>
</head>
<body>
  <header class="top">
    <h1>AURUM∞</h1>
    <nav>
      <a href="index.html">Inicio</a>
      <a href="vision.html">Visión</a>
      <a href="modulos.html">Módulos</a>
      <a class="active" href="numerologia.html">Numerología</a>
      <a href="contacto.html">Contacto</a>
    </nav>
  </header>

  <main>
    <h2 class="gold">Numerología Vibracional</h2>
    <p class="hint">
      Introduce tu <strong>nombre completo</strong> (tal como te presentas) y tu <strong>fecha de nacimiento</strong>.
      Calculamos números Pythagóricos conservando maestros <strong>11/22/33</strong>.
    </p>

    <div class="grid cols-2">
      <div class="card">
        <div class="field">
          <label for="fullName" class="gold">Nombre completo</label>
          <input id="fullName" type="text" placeholder="Tu Nombre Aquí" />
        </div>
        <div class="field" style="margin-top:10px">
          <label for="dob" class="gold">Fecha de nacimiento</label>
          <input id="dob" type="date" />
        </div>
        <div style="margin-top:14px;display:flex;gap:10px;flex-wrap:wrap">
          <button id="calc">Calcular</button>
          <span class="pill"><small>Formato nombre:</small> Pythagorean (A=1… I=9, J=1…)</span>
        </div>

        <details style="margin-top:14px">
          <summary class="gold">Mapa de letras ↔ números</summary>
          <div class="mapping hint" style="margin-top:8px">
            1: A J S · 2: B K T · 3: C L U · 4: D M V · 5: E N W · 6: F O X · 7: G P Y · 8: H Q Z · 9: I R
          </div>
        </details>
      </div>

      <div class="card">
        <h3 class="gold">Resultados</h3>
        <div class="kpi"><span class="n" id="nLife">–</span> <div><strong>Camino de Vida</strong><br><span class="hint" id="tLife">—</span></div></div>
        <div class="kpi"><span class="n" id="nExpr">–</span> <div><strong>Expresión / Destino (Nombre completo)</strong><br><span class="hint" id="tExpr">—</span></div></div>
        <div class="kpi"><span class="n" id="nSoul">–</span> <div><strong>Alma / Deseo (Vocales)</strong><br><span class="hint" id="tSoul">—</span></div></div>
        <div class="kpi"><span class="n" id="nPers">–</span> <div><strong>Personalidad (Consonantes)</strong><br><span class="hint" id="tPers">—</span></div></div>
        <div class="kpi"><span class="n" id="nYear">–</span> <div><strong>Año Personal</strong><br><span class="hint" id="tYear">—</span></div></div>
      </div>
    </div>

    <div class="card">
      <h3 class="gold">Desglose del nombre</h3>
      <table>
        <thead><tr><th>Segmento</th><th>Texto</th><th>Suma</th><th>Reducción</th></tr></thead>
        <tbody id="tbl"></tbody>
      </table>
    </div>
  </main>

  <footer>
    <small>© AURUM∞ · Lemurian UI</small>
  </footer>

  <script>
    // --- Helpers ---
    const VOWELS = 'AEIOUYÁÉÍÓÚÄËÏÖÜ';
    const MAP = {A:1,J:1,S:1,B:2,K:2,T:2,C:3,L:3,U:3,D:4,M:4,V:4,E:5,N:5,W:5,F:6,O:6,X:6,G:7,P:7,Y:7,H:8,Q:8,Z:8,I:9,R:9};
    const clean = s => (s||'').toUpperCase()
        .normalize('NFD').replace(/[\u0300-\u036f]/g,'')
        .replace(/[^A-ZÁÉÍÓÚÄËÏÖÜÑ\s]/g,'').trim();
    const isVowel = ch => VOWELS.includes(ch);
    const digits = n => String(n).split('').map(Number);

    function reduceNum(n, keepMasters=true){
      if(keepMasters && (n===11 || n===22 || n===33)) return n;
      while(n>9){
        const d = digits(n).reduce((a,b)=>a+b,0);
        if(keepMasters && (d===11||d===22||d===33)){ n=d; break; }
        n = d;
      }
      return n;
    }

    function sumName(str){
      let sumAll=0,sumV=0,sumC=0;
      for(const ch of clean(str)){
        if(ch===' ') continue;
        const v = MAP[ch]||0;
        sumAll+=v;
        if(isVowel(ch)) sumV+=v; else sumC+=v;
      }
      return {
        all:{raw:sumAll,red:reduceNum(sumAll)},
        vow:{raw:sumV,red:reduceNum(sumV)},
        con:{raw:sumC,red:reduceNum(sumC)}
      };
    }

    function lifePathFromDate(iso){
      if(!iso) return {raw:null,red:null};
      const d = iso.replace(/-/g,'');
      const raw = d.split('').reduce((a,b)=>a+Number(b),0);
      return {raw,red:reduceNum(raw)};
    }

    function personalYear(iso){
      if(!iso) return {year:null,n:null};
      const b = new Date(iso+'T00:00:00');
      const now = new Date();
      const year = now.getFullYear();
      // Año personal: día + mes de nacimiento + año actual
      const sum = reduceNum(b.getUTCDate() + reduceNum(b.getUTCMonth()+1) + reduceNum(year));
      return {year, n: sum};
    }

    // --- UI ---
    const $ = s => document.querySelector(s);
    const fullName = $('#fullName');
    const dob = $('#dob');

    // Persistencia simple
    fullName.value = localStorage.getItem('num:name') || '';
    dob.value = localStorage.getItem('num:dob') || '';

    $('#calc').addEventListener('click', ()=>{
      const name = fullName.value.trim();
      const birth = dob.value;

      if(!name){ alert('Escribe tu nombre completo.'); return; }
      if(!birth){ alert('Selecciona tu fecha de nacimiento.'); return; }

      localStorage.setItem('num:name', name);
      localStorage.setItem('num:dob', birth);

      // Cálculos
      const s = sumName(name);
      const life = lifePathFromDate(birth);
      const pYear = personalYear(birth);

      // Pintar KPIs
      $('#nLife').textContent = life.red ?? '–';
      $('#tLife').textContent = 'Camino según fecha de nacimiento';

      $('#nExpr').textContent = s.all.red;
      $('#tExpr').textContent = `Suma del nombre (${s.all.raw}) → ${s.all.red}`;

      $('#nSoul').textContent = s.vow.red;
      $('#tSoul').textContent = `Vocales (${s.vow.raw}) → ${s.vow.red}`;

      $('#nPers').textContent = s.con.red;
      $('#tPers').textContent = `Consonantes (${s.con.raw}) → ${s.con.red}`;

      $('#nYear').textContent = pYear.n ?? '–';
      $('#tYear').textContent = pYear.year ? `Año personal para ${pYear.year}` : '—';

      // Tabla
      const parts = clean(name).split(/\s+/).filter(Boolean);
      const rows = parts.map(p=>{
        const ss = sumName(p);
        return `<tr><td>${p}</td><td>${p}</td><td>${ss.all.raw}</td><td>${ss.all.red}</td></tr>`;
      }).join('');
      $('#tbl').innerHTML =
        rows +
        `<tr><td><strong>Total</strong></td><td></td><td><strong>${s.all.raw}</strong></td><td><strong>${s.all.red}</strong></td></tr>`;
    });
  </script>
</body>
</html>