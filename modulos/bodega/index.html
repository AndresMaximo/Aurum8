<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Bodega · AURUM∞</title>
<link rel="stylesheet" href="/aurum-theme.css">
<link rel="stylesheet" href="/common/topbar.css">
<style>
  .wrap{max-width:1100px;margin:24px auto;padding:0 16px}
  .card{background:#0b0f12;border:1px solid #1e2b33;border-radius:16px;padding:16px;margin-bottom:16px}
  table{width:100%;border-collapse:collapse}
  th,td{padding:10px;border-bottom:1px solid #1e2b33}
  .muted{opacity:.7}
</style>
</head>
<body>
<div id="topbar"></div>

<main class="wrap">
  <h1>Bodega</h1>
  <p class="muted">Estado de conexión: <b data-conn>—</b></p>

  <section class="card">
    <h2>Inventario</h2>
    <table id="tabla-inventario">
      <thead><tr><th>SKU</th><th>Nombre</th><th>Stock</th></tr></thead>
      <tbody><tr><td colspan="3">—</td></tr></tbody>
    </table>
  </section>
</main>

<script>fetch('/common/topbar.html').then(r=>r.text()).then(t=>document.getElementById('topbar').innerHTML=t)</script>
<script type="module" src="/supabaseClient.js"></script>
<script type="module" src="/aurum-data.js"></script>
<script type="module">
  import { listarInventario, pintarEstadoConexion } from "/aurum-data.js";
  pintarEstadoConexion();

  const tbody = document.querySelector("#tabla-inventario tbody");
  async function cargar(){
    tbody.innerHTML = '<tr><td colspan="3">Cargando…</td></tr>';
    try{
      const items = await listarInventario();
      tbody.innerHTML = items.length
        ? items.map(i=>`<tr><td>${i.sku}</td><td>${i.nombre}</td><td>${i.stock}</td></tr>`).join("")
        : '<tr><td colspan="3">Sin stock</td></tr>';
    }catch(e){ console.error(e); tbody.innerHTML = '<tr><td colspan="3">Error</td></tr>'; }
  }
  cargar();
</script>
</body>
</html>